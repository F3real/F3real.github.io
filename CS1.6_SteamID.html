
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="author" content="F3real" />
        <meta name="keywords" content="cs 1.6,reversing,cheat engine" />
        <meta name="description" content="How to change steamID for non-steam CS 1.6 version" />


    <title>CS 1.6 Steam ID Changer - EnSec blog</title>

    <link href="https://f3real.github.io/theme/css/combined.css" rel="stylesheet" />

    <!-- Feeds -->
</head>
<body data-spy="scroll" data-target="#scrollspy">
    <div id="wrapper">
        <!-- Sidebar -->
        <nav id="sidebar-wrapper-small" class="twitchy-background">
            <ul id="accordion-small" class="sidebar-nav sidebar-nav-small">
                <li>
        <a href="https://f3real.github.io" title="EnSec blog" class="collapsed">
            <span class="fas fa-home"></span>
        </a>
    </li>
                <li class="nav-divider"></li>
                <li>
        <a href="https://f3real.github.io/archives.html" title="Recent Articles" class="collapsed">
            <span class="fas fa-th-list"></span>
        </a>
    </li>
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion-small" href="#collapse-social-small" title="Social" class="collapsed">
                        <i class="fas fa-users padding-small"></i>
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social-small" class="collapse ">
                    <li>
                        <a href="https://github.com/F3real" title="Github"><i class="fab fa-github-square padding-small"></i></a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/stefan-ili%C4%87-61a004111" title="Linkedin"><i class="fab fa-linkedin padding-small"></i></a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
        <a href="#" title="Back to top" class="collapsed">
            <span class="fas fa-arrow-up"></span>
        </a>
    </li>
            </ul>
        </nav>
        <nav id="sidebar-wrapper" class="twitchy-background">
            <ul id="accordion" class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="https://f3real.github.io/">
                            <span class="fas fa-home padding-small"></span>
                            EnSec blog
                    </a>
                </li>
                    <li>
                        <a href="https://f3real.github.io/archives.html">
                            <span class="fas fa-th-list padding-small"></span>
                            Archives
                        </a>
                    </li>
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-social">
                        <i class="fas fa-users padding-small"></i>
                        Contact
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social" class="sidebar_submenu collapse ">
                    <li>
                        <a href="https://github.com/F3real" title="Github">
                            <i class="fab fa-github-square padding-small"></i>
                            Github
                        </a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/stefan-ili%C4%87-61a004111" title="Linkedin">
                            <i class="fab fa-linkedin padding-small"></i>
                            Linkedin
                        </a>
                    </li>
                </ul></li>
                
                <li class="nav-divider"></li>
                <li class="panel anti-panel"><ul id="collapse-pages" class="sidebar_submenu collapse ">
                </ul></li>
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-categories">
                        <i class="fas fa-folder-open padding-small"></i>
                        Categories
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-categories" class="sidebar_submenu collapse ">
                    <li >
                        <a href="https://f3real.github.io/category/ctf.html">
                            <i class="fas fa-folder-open padding-small"></i>
                            ctf
                            <span class="badge badge-secondary float-right categorybadge">28</span>
                        </a>
                    </li>
                    <li >
                        <a href="https://f3real.github.io/category/misc.html">
                            <i class="fas fa-folder-open padding-small"></i>
                            misc
                            <span class="badge badge-secondary float-right categorybadge">15</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="https://f3real.github.io/category/reversing.html">
                            <i class="fas fa-folder-open padding-small"></i>
                            reversing
                            <span class="badge badge-secondary float-right categorybadge">6</span>
                        </a>
                    </li>
                    <li >
                        <a href="https://f3real.github.io/category/tutorial.html">
                            <i class="fas fa-folder-open padding-small"></i>
                            tutorial
                            <span class="badge badge-secondary float-right categorybadge">5</span>
                        </a>
                    </li>
                </ul></li>
            </ul>
        </nav>
        <!-- /#sidebar-wrapper -->
        <!-- open/close sidebar -->
        <button onclick="toggleMenu();return false;" class="btn btn-primary" id="menu-toggle">
            <span id="right-arrow" class="fas fa-chevron-right"  title="expand sidebar"></span>
            <span id="left-arrow" class="fas fa-chevron-left" title="minimize sidebar"></span>
        </button>
       <!-- /open/close sidebar -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
<section id="content">
    <article>
        <div class="row">
            <div class="col-lg-10">
                <header class="page-header">
                    <h1>
                        <a href="https://f3real.github.io/CS1.6_SteamID.html"
                           rel="bookmark"
                           title="Permalink to CS 1.6 Steam ID Changer">
                            CS 1.6 Steam ID Changer
                        </a>
                        <small>
<div class="post-info">
    <div class="publish-info-block">
        <small>
            <span class="published">
                <i class="fa fa-calendar padding-small"></i><time datetime="2018-12-03T10:01:00+01:00"> Mon 03 December 2018</time>
            </span>
            <span class="category">
                <i class="fa fa-folder-open padding-small"></i><a href="https://f3real.github.io/category/reversing.html">reversing</a>
            </span>
            <span class="tags">
                <i class="fa fa-tags padding-small"></i>
                <a href="https://f3real.github.io/tag/cs-16.html">cs 1.6</a> /                 <a href="https://f3real.github.io/tag/reversing.html">reversing</a> /                 <a href="https://f3real.github.io/tag/cheat-engine.html">cheat engine</a>            </span>
        </small>
    </div>
</div><!-- /.post-info -->                        </small>
                    </h1>
                </header>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-10">
                <div class="entry-content">
                    <p>Cs 1.6 is FPS that got released in 2000, but it is still played both on steam and non-steam servers.
This post will be focused on finding a way to unban ourselves while using a non-steam version of the game.
Required software:</p>
<ul>
<li>Cheat Engine 6.8.1</li>
<li>Cs 1.6 Warzone Build 4554</li>
</ul>
<p>Browsing posts about SteamID internet we see that there are few different ways being mentioned that admins can use to ban players from their server:</p>
<ul>
<li>SteamID</li>
<li>MAC</li>
<li>IP</li>
<li>HWID (Hard disk volume ID)</li>
</ul>
<p>SteamID is not static value for non-steam players, even reinstalling game can change it. Plugins can also use custom ways of calculating it so the same player can have 2 different SteamIDs on two different servers.</p>
<p>To check our SteamID, we can just type <code>status</code> in console (opens with <code>~</code>)
after connecting to the game (either local or online).</p>
<p>The first step of changing our ID is to locate it in memory. For this, we can use Cheat Engine. After connecting to process we can just search for the value we have gotten from <code>status</code> command.</p>
<p><img alt="Opening process in CheatEngine" class="img-fluid centerimage" src="https://f3real.github.io/images/2018_12_3_OpeningProcess_CheatEngine.png"></p>
<p>As we see the address is not fixed, rather it is in form base dll  + offset
(<code>steamclient.dll + 0x5AC4C</code>).</p>
<p><img alt="Finding memory address in CheatEngine" class="img-fluid centerimage" src="https://f3real.github.io/images/2018_12_3_FindingMemoryAddress_CheatEngine.png"></p>
<p>Now we can simply change this value to get ourselves unbanned from most servers, but there are few interesting things worth mentioning.</p>
<ul>
<li>SteamID is only set after you first enter the server (either local or online). Changing value before will just result in it being overwritten after we enter the server.</li>
<li>If the server is using a custom way to calculate SteamID we won't be able to find that value in memory (at least in my testing), but still changing our local SteamID will affect it so it is probably derived in some way from it.
The best way to find the location of SteamID (the local one) is, therefore, to create a local server and check it.</li>
</ul>
<p>Since we know the location of our SteamID we can automate the process of changing it.
CheatEngine gives us the ability to write Lua scripts (<code>Table-&gt;Show Cheat Table Lua Script</code>).
CheatEngine is not the most documented software, but browsing trough the forum it is easy to find enough to write our exploit.</p>
<div class="highlight"><pre><span></span><code>    <span class="kr">function</span> <span class="nf">openCS</span><span class="p">()</span>
        <span class="n">procFound</span> <span class="o">=</span> <span class="n">openProcess</span><span class="p">(</span><span class="s2">&quot;hl.exe&quot;</span><span class="p">);</span>
        <span class="kr">if</span> <span class="n">procFound</span> <span class="kr">then</span>
            <span class="kr">return</span> <span class="kc">true</span>
        <span class="kr">end</span>
        <span class="kr">return</span> <span class="kc">false</span>
    <span class="kr">end</span>

    <span class="kr">function</span> <span class="nf">changeSteamID</span><span class="p">()</span>
        <span class="kr">if</span> <span class="ow">not</span> <span class="n">openCS</span><span class="p">()</span> <span class="kr">then</span>
            <span class="kr">return</span> <span class="kc">nil</span>
        <span class="kr">end</span>
        <span class="n">current_SteamID</span> <span class="o">=</span> <span class="n">readSteamID</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">current_SteamID</span><span class="p">)</span>
        <span class="n">writeInteger</span><span class="p">(</span><span class="n">steamID_addr</span><span class="p">,</span> <span class="n">current_SteamID</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">readSteamID</span><span class="p">())</span>
    <span class="kr">end</span>

    <span class="kr">function</span> <span class="nf">getSteamIDAddress</span><span class="p">()</span>
        <span class="n">steamID_addr_offset</span> <span class="o">=</span> <span class="mh">0x5AC4C</span>
        <span class="n">steamClient_addr</span> <span class="o">=</span> <span class="n">getAddress</span><span class="p">(</span><span class="s2">&quot;steamclient.dll&quot;</span><span class="p">)</span>
        <span class="n">steamID_addr</span> <span class="o">=</span> <span class="n">steamID_addr_offset</span> <span class="o">+</span> <span class="n">steamClient_addr</span>
        <span class="kr">return</span> <span class="n">steamID_addr</span>
    <span class="kr">end</span>

    <span class="kr">function</span> <span class="nf">readSteamID</span><span class="p">()</span>
        <span class="n">current_SteamID</span> <span class="o">=</span> <span class="n">readInteger</span><span class="p">(</span><span class="n">getSteamIDAddress</span><span class="p">())</span>
        <span class="kr">return</span> <span class="n">current_SteamID</span>
    <span class="kr">end</span>
    <span class="n">changeSteamID</span><span class="p">()</span>
</code></pre></div>

<p>We can save the created script as <code>.CETRAINER</code> so we can run it without starting the whole CheatEngine.</p>
                </div>
                <footer class="text-right">
                    <p>- F3real</p>
                </footer>
    <div id="show-comments" class="span7 text-center">
        <a href="https://f3real.github.io/CS1.6_SteamID.html#disqus_thread"
          data-disqus-identifier="CS1.6_SteamID"
        class="btn btn-primary twitchy-background">Show Comments</a>
    </div>
    <section id="comments" class="comments hidden">
        <hr/>
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </section>
            </div>
        </div>
    </article>
</section>
<footer>
    <hr>
    <div class="row">
        <div class="col-lg-10 text-center">
            <p><small>
                Built by <a href="http://docs.getpelican.com/en/latest">Pelican</a> / <a href="https://github.com/F3real/pelican-twitchy">pelican-twitchy</a>
                &middot;                    &copy; 2024 F3real
            </small></p>
        </div>
    </div>
</footer>            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>
    <!-- /#wrapper -->

<!-- disqus -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'https-f3real-github-io'; // required: replace example with your forum shortname

            var disqus_identifier = 'CS1.6_SteamID';
        var disqus_url = 'https://f3real.github.io/CS1.6_SteamID.html';

    var disqus_config = function () {
        this.language = "en";
    };

        var commentsDiv = document.getElementById('show-comments');
        commentsDiv.onclick = function() {
            /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
            this.style.display = 'none';        
        };
</script>
<!-- /disqus -->
    <script>
        const wrapper = document.getElementById('wrapper');
        const sidebarBig = document.getElementById('sidebar-wrapper');
        const sidebarSmall = document.getElementById('sidebar-wrapper-small');

        const triggers = Array.from(document.querySelectorAll('[data-toggle="collapse"]'));
        for (var i = 0; i < triggers.length; i++) { 
            triggers[i].addEventListener('click', (ev) => {
                const elm = ev.currentTarget;    
                ev.preventDefault();
                const selector = elm.getAttribute('href').replace('#','');
                elm.classList.toggle('collapsed');
                document.getElementById(selector).classList.toggle('show');
            }, false);
        } 

        function showBigNav() {;
            sidebarBig.style.display = 'block';
            sidebarSmall.style.display = 'none';
        }
        function showSmallNav() {
            sidebarBig.style.display = 'none';
            sidebarSmall.style.display = 'block';
        }

        const mediaQuery = window.matchMedia('(min-width:768px)');
        mediaQuery.onchange = e => {
            if (wrapper.classList.contains('toggled')) {
                    wrapper.classList.remove('toggled');
            } else {
                if (e.matches) {
                    showBigNav();
                } else {
                    showSmallNav();
                }
            }
        }

        function setNavbar() {
            var condition = wrapper.classList.contains('toggled');
            if (!mediaQuery.matches) {
                condition = !condition;
            }
            if (condition) {
                showSmallNav();
            } else {
                showBigNav();
            }
        }

        function toggleMenu(){
            wrapper.classList.toggle('toggled');
            setNavbar();
        }

        window.onload = setNavbar;
    </script>
	<script data-goatcounter="https://f3real.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</body>
</html>